{% extends "base.html" %}
{% load url from future %}

{% load breadcrumbs %}

{% block content %}
	<br/>
	
	<div class="row-fluid">
		<div class="span3">
			<ul class="nav nav-pills">
			  <li><a href="{% url 'browse-analysis' %}">Mes analyses</a></li>
			  <li class="active"><a href="{% url 'browse-datasource' %}">Mes fichiers</a></li>
			</ul>
		</div>
		<div class="span7">
			{{ path|breadcrumb }}
		</div>
		<div class="span2">
			<button class="btn btn-primary" href="#upload-file" role="button" data-toggle="modal"><i class="icon-upload icon-white"></i> Importer</button>					
		</div>
	</div>
	<div id="message"></div>
	
		
	<div class="row-fluid" id="folders">
	  	<div class="span12">
		 	
		 	{% for dir in directories %}
	  		<div class="span2" >
	  			<p class="text-center">
	  			<a href="?path={{ path }}/{{ dir }}"><img src="{{ STATIC_PREFIX }}/img/folder.png" /></a>
	  			<br/>
	  			<span>{{ dir }}
	  			</p>
	  		</div>
			{% endfor %}
			
			{% for file in files %}
		  		<div class="span2"><p class="text-center"><a href="{% url 'create-analysis' %}?dpath={{ path }}/{{ file }}"><img src="{{ STATIC_PREFIX }}/img/file.png" /></a>
	  			<br/>
	  			<span>{{ file }} <i class="icon-remove" title="Supprimer"></i></span>
	  			</p>
	  			</div>
			{% endfor %}
			
		
		</div>
	
	<div  class="row-fluid">
		<div id="upload_file" class="span12">
		<hr>
		<h2>Importer un fichier</h2>
				{% if upload_form.errors %}
					<div class="alert alert-error">
						<h4>Erreur!</h4>
						<p>{{upload_form.errors}}</p>
					</div>
				{% endif %}
				
				<form method="post" action="{% url 'upload-datasource' %}" enctype="multipart/form-data">
				{% csrf_token %}
				<input type="file" name="{{ upload_form.file.name }}" id="id_file" accept=".csv" runat="server" />
				<input name="path" type="hidden" value="{{ path }}" />
			    <button id="submit_file" class="btn btn-primary" type="submit" >Importer</button>
				</form>
				
				</div>
		
		</div>
	</div>

{% endblock %}